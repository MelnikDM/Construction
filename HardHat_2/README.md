# HardHat

### Описание проблемы
Данный проект посвящен распознаванию средств индивидуальной защиты у рабочих и ИТР.
В автоматическим режиме предполагается детектировать у работников строительной площадки наличие защитных касок и сигнальных жилетов.
Работники без обязательных к использованию средств индивидуальной защиты не допускаются ни к выполнению строительных работ,
ни на саму строительную площадку.

**Ношение СИЗ направлено на профилактику производственного травматизма и является обязательным**, что определено Приказом Минтруда РФ от 11.12.2020 N 883Н.
Средства индивидуальной защиты должны выдаваться работникам на предприятии в обязательном порядке. 
Статьями 212 и 213 Трудового кодекса закеплено, что контроль за выдачей и ношением СИЗ лежит на работодателе. 
За количеством, комплектностью и состоянием СИЗ также должен следить работодатель.

Дальнейшее использование защиты хоть и зависит от работника, но по-прежнему контролируется ответственными лицами предприятия. 
Обычно контроль выражается в форме еженедельных обходов инженеров по ОТ и ТБ, по результатам которых выдаются предписания для устранения выявленных нарушений.
Очевидно, что это не самый эффективный метод: как только инженер ОТ и ТБ уходит, рабочие снова могут снять с себя СИЗ. 
В таком случае ни о какой профилактике травматизма не может быть и речи. 

С развитием машинного обучения и нейронных сетей, а также с улучшением этики производства все больше и больше строительных объектов
оснащается современными средствами видеофиксации. Причем камеры используются не только для периметральной охраны стройплощадки 
(чтобы никто не залез; никто ничего не вынес), но и для контроля ношения СИЗ, учета рабочего времени, подсчета работников на стройплощадке.

Таким образом, видеоаналитика – это современный способ для контроля строительных процессов, в том числе и применения СИЗ.
Используя камеры и искусственный интеллект, можно мониторить безопасность каждого сотрудника в режиме реального времени.
Система сама распознает опасную ситуацию и отправит сигнал на пульт диспетчеру.

### Задача

Задача распознавания СИЗ в данном конкретном случает относится к задаче **Object Detection**.

1. Детекция (выявление каски и жилетов на работниках стройплощадки);
2. Классификация (определение, что каска - это каска, а не шапка).

Для имплементации модели, которая будет решать данную задачу, в качестве основной архитектуры была выбрана **[YOLOv5m](https://github.com/ultralytics/yolov5)**.
В качестве дополнительной для сравнения – **[SSD300](https://github.com/sgrvinod/a-PyTorch-Tutorial-to-Object-Detection)** на базе VGG16.

За основную метрику оценки качества обучения и сравнения результатов мы возьмем mAP (mean Average Precision). mAP сравнивает истинные баундинг боксы с предсказанными
и выдает оценку. IoU (Intersection over Union) мы примем равным 0.5 (далее - mAP@0.5). 

### Описание датасета

В качестве данных для модели распознавания СИЗ использовался собранный автором проекта датасет, состоящий на 70% из фотографий, сделанных автором на работе, и
на 30% из открытых источников. Всего на данный момент в датасете (без аугментаций) *807* уникальных фотографий. 

![Изображение](https://github.com/MelnikDM/Construction/blob/main/HardHat_2/images/Img_examples.png)

Количество аннотаций равно - *5,383* штукам. 
После проведения препроцессинга и аугментации у нас стало *2,169* фотографий. В качестве препроцессинга было применено изменение размера изображений до 640х640.
А аугментации включали в себя:

- Горизонтальный переворот (Flip);
- Случайное вращение в диапазоне от -15 до +15 градусов;
- Экспозиция (от -15% до +15%);
- Шумы (до 2% пикселей).

Все мероприятия по разметке данных, их препроцессингу и аугментации выполнялись средствами **[Roboflow](https://app.roboflow.com/melnikdm/)**. Фотографии были размечены в формате PASCAL VOC (.xml).
 
В процессе "исследования" над датасетом было проделано n-ное количество манипуляций ряд которых показал себя не с лучшей стороны. К таковым следует отнести разного рода обрезки (Crops) и увеличения (Extensions), которые зачастую выводили искомые жилеты и каски за границы изображений. Как итог, вместо нового изображения мы получали изображение без какой-либо разметки, на которое ругалась YOLOv5m.

Датасет разделен на 4 класса (количество боксов указано до аугментации):

1. Helmet (1,993 бокса);
2. NoHelmet (886 боксов);
3. Jacket (1,517 боксов);
4. NoJacket (987 боксов).

После всех манипуляций количество баундинг боксов существенно увеличилось и стало **14,770** штук. Распределение можно увидеть на картинке ниже. 

 ![Изображение](https://github.com/MelnikDM/Construction/blob/main/HardHat_2/images/Annot_per_class.png)

Таким образом, нашей моделью мы будем детектировать ношение работниками стройплощадки касок и сигнальных жилеток. К каскам мы относим защитные каски белого,
оранжевого, желтого, красного и синего цветов, согласно старым требованиями ГОСТ 12.4.087-84. К сигнальным жилетам мы относим спецодежду желтого, красного, оранжевого цветов
с обязательной флуоресцентной полосой (на деле, что относить к сигнальным жилетам - вопрос дискуссионный и зависит как от характера строительства (газовщики и нефтянники носят
другие "расцветки"), так и от заведенного внутреннего регламента по ОТ и ТБ). 
 

 
 
